<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>参加者チェック</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="style.css">
</head>
<body>

<h2>参加者チェック</h2>

<div style="text-align:center; margin-bottom:15px;">
    <button onclick="location.href='players.html'" class="btn green">名前管理</button>
    <button onclick="loadPlayers()" class="btn green">参加者読み込み</button>
</div>

<p style="text-align:center;">参加者として「今日来ている人」にチェックを入れてください。</p>

<div id="playerList"></div>

<div style="text-align:center; margin-top:20px;">
    <button onclick="checkAll()" class="btn green">全員 ON</button>
    <button onclick="uncheckAll()" class="btn red">全員 OFF</button>
</div>

<div style="text-align:center; margin-top:20px;">
    <button onclick="saveActivePlayers()" class="btn green">参加者を保存する</button>
</div>

<script>
// プレイヤー一覧を読み込む
function loadPlayers() {
    const list = JSON.parse(localStorage.getItem("players") || "[]");
    const active = JSON.parse(localStorage.getItem("activePlayers") || "[]");

    let html = "";
    list.forEach(name => {
        const checked = active.includes(name) ? "checked" : "";
        html += `
            <div class="checkbox-line">
                <label>
                    <input type="checkbox" data-name="${name}" ${checked}>
                    ${name}
                </label>
            </div>
        `;
    });

    document.getElementById("playerList").innerHTML = html;
}

// 全員オン
function checkAll() {
    document.querySelectorAll("#playerList input[type='checkbox']")
        .forEach(cb => cb.checked = true);
}

// 全員オフ
function uncheckAll() {
    document.querySelectorAll("#playerList input[type='checkbox']")
        .forEach(cb => cb.checked = false);
}

// 参加者保存 → 自動で index.html に移動
function saveActivePlayers() {
    const checked = [];
    document.querySelectorAll("#playerList input[type='checkbox']").forEach(cb => {
        if (cb.checked) checked.push(cb.dataset.name);
    });

    if (checked.length < 4) {
        alert("4人以上選択してください");
        return;
    }

    localStorage.setItem("activePlayers", JSON.stringify(checked));
    alert("保存しました！試合作成画面へ移動します。");

    // ⬇ 保存後に自動移動（あなたのトップページに合わせて変更してOK）
    location.href = "index.html";
}

// 初回ロード
window.onload = loadPlayers;
</script>

</body>
</html>
